
<!doctype html>
<!--[if IE 9]><html class="lt-ie10" lang="en" > <![endif]-->
<html class="no-js" lang="en" dir="ltr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Seccubus</title>

    <link href="/css/app.css" rel="stylesheet" />
    <script src="/js/vendor/modernizr.js"></script>
    <link rel="alternate" type="application/rss+xml" title="Seccubus" href="https://www.seccubus.com/feed.xml">
</head>
<body class="antialiased hide-extras">
    <nav class="top-bar" data-topbar role="navigation">
    <ul class="title-area">
        <li class="name">
            <h1><a href="/">Seccubus</a></h1>
        </li>
        <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
        <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
    </ul>
    <section class="top-bar-section">
        <!-- Right Nav Section -->
        <ul class="right">
            

<li class="divider"></li>
<li class="
    
    
    
">
    <a href="/news/">
        News
    </a>
    
</li>

<li class="divider"></li>
<li class="
    
    
     has-dropdown
">
    <a href="">
        About
    </a>
    
        <ul class="dropdown">
            

<li class="divider"></li>
<li class="
    
    
    
">
    <a href="/about/what-is-seccubus/">
        What is Seccubus?
    </a>
    
</li>

<li class="divider"></li>
<li class="
    
    
    
">
    <a href="/about/about-the-authors/">
        About the authors
    </a>
    
</li>

<li class="divider"></li>
<li class="
    
    
    
">
    <a href="/about/about-the-name/">
        About the name
    </a>
    
</li>


        </ul>
    
</li>

<li class="divider"></li>
<li class="
     active
    
     has-dropdown
">
    <a href="/documentation">
        Documentation
    </a>
    
        <ul class="dropdown">
            

<li class="divider"></li>
<li class="
    
    
    
">
    <a href="/documentation#v1">
        Version 1
    </a>
    
</li>

<li class="divider"></li>
<li class="
    
    
    
">
    <a href="/documentation#v2">
        Version 2
    </a>
    
</li>

<li class="divider"></li>
<li class="
    
    
    
">
    <a href="/documentation#faq">
        FAQ
    </a>
    
</li>

<li class="divider"></li>
<li class="
    
    
     has-dropdown
">
    <a href="">
        Mailing List
    </a>
    
        <ul class="dropdown">
            

<li class="divider"></li>
<li class="
    
    
    
">
    <a href="/mailing_list/subscribe/">
        Subscribe
    </a>
    
</li>

<li class="divider"></li>
<li class="
    
    
    
">
    <a href="/mailing_list/archive/">
        Archive
    </a>
    
</li>


        </ul>
    
</li>


        </ul>
    
</li>

<li class="divider"></li>
<li class="
    
    
     has-dropdown
">
    <a href="https://github.com/schubergphilis/Seccubus_v2/">
        GitHub
    </a>
    
        <ul class="dropdown">
            

<li class="divider"></li>
<li class="
    
    
    
">
    <a href="https://github.com/schubergphilis/Seccubus_v2/">
        Fork
    </a>
    
</li>

<li class="divider"></li>
<li class="
    
    
    
">
    <a href="https://github.com/schubergphilis/Seccubus_v2/issues">
        Issue tracker
    </a>
    
</li>

<li class="divider"></li>
<li class="
    
    
    
">
    <a href="https://github.com/schubergphilis/Seccubus_v2/releases">
        Download
    </a>
    
</li>


        </ul>
    
</li>

<li class="divider"></li>
<li class="
    
     has-form
    
">
    <a href="https://github.com/schubergphilis/Seccubus_v2/releases" class="button">
        Download
    </a>
    
</li>


        </ul>
    </section>
</nav>

    <section class="main-content article">
    <div class="large-9 medium-10 small-11 small-centered column">
        <h2>
            Setting up a scan
        </h2>
        <div class="content post">
            <p>Before you set up a scan you need to have the following information:</p>

<ul>
<li>IP Address(es) or hostname(s) to be scanned</li>
<li>Nessus daemon to be used (if different from the daemon specified in etc/config)</li>
<li>Email adres to mail the results to (if different then the one provided inetc/config)</li>
<li>(Optional) Commands to execute before and after the scan</li>
<li>Who has or does not have permission to see this scan in the GUI</li>
<li>When the scan needs to run</li>
</ul>

<p>This chater assumes you want to setup a scan called localhost which scans
127.0.0.1 and mails the results back to root@localhost.</p>

<p>All the example commands assume that you have the identity of the user
seccubus</p>

<h1>Copying the skeleton directory</h1>

<p>The var directory contains a .skel directory that contains all the
subdirectories you need. Copy this directory to a directory with the name of
your scan.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&gt;cd ~/var


&gt; cp -r .skel localhost 
</code></pre></div>
<h1>Modifying the hosts file</h1>

<p>The file var/<scanname>/hosts specifies which targets to scan. Each line
contains a single target which can be any of the following:</p>

<ul>
<li>hostname – e.g. localhost or <a href="http://www.seccubus.com">www.seccubus.com</a></li>
<li>ip address – e.g. 127.0.0.1</li>
<li>subnet – e.g. 127.0.0.0/24 </li>
<li>range – e.g. 127.0.0.1-255</li>
</ul>

<h1>Modifying the per scan configuraiton file</h1>

<p>The file var/<scanname>/config contains configuration directives which are
valid for this specific scan only. Any parameter from etc/config can be
overwritten here. Usefull parameters are:</p>

<p>** Parameter** | *<em>Meaning<br>
*</em><br>
---|---<br>
MODE  | Mode wil determine which configuration from etc if used if mode is set
to full full-nessusrc will be used, alternatives are safe and portscan which
will cause Seccubus to use safe-nessusrc or portscan-nessusrc. You can supply
your own nessusrc files if you want to as well.<br>
EMAIL | Override the default email address for this scan<br>
PRESCAN | A unix command that will be executed prio to the scan<br>
POSTSCAN |</p>

<p>A unix command that will be executed after the scan  </p>

<p>In the example the config file will look like this.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">MODE=&quot;full&quot;


EMAIL=&quot;root@localhost&quot;
</code></pre></div>
<h1>Setting GUI permissions</h1>

<p>If only certain users have permission to see a scan in the GUI you have to
options:</p>

<ul>
<li>var/<scanname>/.allow – use this file to specify (one per line) the usernames of te users that can access this scan – other users will not be able to access the scan</li>
<li>var/<scanname>/.deny – use this file to specify (one per line) the usernames of te users that cannot access this scan – other users will be able to access the scan</li>
</ul>

<p>A user will have access when:</p>

<ul>
<li>No .allow and .deny files exist</li>
<li>His name is in .allow (if it exists) and</li>
<li>His name is not in .deny (if it exists)</li>
</ul>

<h1>Scheduling the scan via crontab</h1>

<p>The scans are actually run via the ‘bin/do-scan <scanname>’ command. In order
to start the localhost scan each night at 1:10 you would specify:</p>

<p>10 1 * * * bin/do-scan localhost</p>

<p>Type ‘<a href="http://unixhelp.ed.ac.uk/CGI/man-cgi?crontab+5">man 5 crontab</a>‘ on the
unix command prompt to learn more about scheduling tasks via cron.</p>

<h2>Every odd/even/fourth week</h2>

<p>Crontab by default does not allow you to schedule jobs based on the <a href="http://www.proesite.com/timex/wkcalc.htm">ISO
weeknumer</a>.In order allow you to
schedule command on e.g. 6:00 on every wednessday of the odd weeks, Seccubus
includes the script called bin/EveryXXXWeek.pl.</p>

<p>EveryXXXWeek.pl has the following command syntax.</p>

<p>EveryXXXWeek.pl “<unix command>” <divider> <remainder> so e.g. to run “echo
yes” in odd weeks you could type: ‘bin/EveryXXXWeek.pl “echo yes” 2 1′. In tis
case it would take the current week number and divide it by 2. If the remained
is 1 if will execute “echo yes”.</p>

<p>To schedule a scan called localhost on 6:00 on every wednessday of the odd
weeks specify the following in crontab.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">0 6 * * wed bin/EveryXXXWeek.pl &quot;bin/do-scan localhost&quot; 2 1
</code></pre></div>
<h2>Every x-th someday of the month.</h2>

<p>Cron also does allow you to schedule something on e.g. the second friday of
each month. One would expect that the following would work.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">0 0 8-14 * fri bin/do-scan localhost
</code></pre></div>
<p>Whoevery this would run this command every day between the 8th and 14th day of
the month and on every friday. So Seccubus does come with EveryXXXDay.sh its
syntax is:</p>

<p>EveryXXXday.sh “<unix command>” <daynum> where daynum is a 0 or 7 for sunday,
1 for monday, etc.</p>

<p>So to run the localhost scan on the second friday of each month we would need
the following entry crontab entry.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">0 0 8-14 * * bin/EveryXXDay.sh &quot;bin/do-scan localhost&quot; 5
</code></pre></div>
<h1>Running a scan manually</h1>

<p>Scan can be run manually by typing</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&gt; cd ~; bin/do-scan locahost
</code></pre></div>
<p>As the seccubus user.</p>

        </div>
    </div>
</section>

    </section>
    <script src="/js/vendor/jquery.js"></script>
    <script src="/js/foundation/foundation.js"></script>
    <script src="/js/foundation/foundation.topbar.js"></script>
    <script>
    $(document).foundation();
    </script>
</body>
</html>
